//
//   Generated by https://github.com/blacktop/ipsw (Version: 3.1.454, BuildTime: 2024-02-08T22:07:34Z)
//
//    - LC_BUILD_VERSION:  Platform: watchOSSimulator, MinOS: 10.2, SDK: 10.2, Tool: ld (902.8)
//    - LC_SOURCE_VERSION: 1838.60.8.0.0
//
#ifndef NEIKEv2Session_h
#define NEIKEv2Session_h
@import Foundation;

#include "NEIKEv2ChildSAConfiguration.h"
#include "NEIKEv2ConfigurationDelegate-Protocol.h"
#include "NEIKEv2ConfigurationMessage.h"
#include "NEIKEv2IKESA.h"
#include "NEIKEv2IKESAConfiguration.h"
#include "NEIKEv2Packet.h"
#include "NEIKEv2RTT.h"
#include "NEIKEv2TransportDelegate-Protocol.h"
#include "NEIPSecSASession.h"
#include "NEIPSecSASessionDelegate-Protocol.h"

@class NSMutableArray, NSMutableDictionary, NSString, NWEndpoint;
@protocol NEIKEv2PacketDelegate, OS_dispatch_queue, OS_dispatch_source;

@interface NEIKEv2Session : NSObject<NEIKEv2TransportDelegate, NEIPSecSASessionDelegate> {
  /* instance variables */
  BOOL _isListening;
  BOOL _ownsDatabaseSession;
  BOOL _ownsIPSecInterface;
  BOOL _isAborted;
  BOOL _isInvalidated;
  BOOL _isExpectingConfigBlock;
  BOOL _hasContactedConfigurationDelegate;
  BOOL _hasOutboundRequestInFlight;
  int _lastRequestMessageID;
  int _lastReceivedMessageID;
  int _previousMOBIKEMessageID;
  id /* block */ _ikeSocketHandler;
  NEIKEv2ChildSAConfiguration *_listenChildSAUserConfig;
  NEIPSecSASession *_databaseSession;
  NSMutableDictionary *_databaseLarvalSAs;
  NSMutableDictionary *_databaseSAs;
  id /* block */ _lastRequestReplyHandler;
  id /* block */ _waitingRequestHandler;
  NSMutableDictionary *_sentRequests;
  NSMutableDictionary *_sentReplies;
  NSMutableDictionary *_receivedRequests;
  NSMutableDictionary *_receivedReplies;
  NSMutableDictionary *_requestFragmentMaps;
  NSMutableDictionary *_replyFragmentMaps;
  NSObject<OS_dispatch_source> *_ikeLifetimeTimer;
  NSObject<OS_dispatch_source> *_dpdDispatchTimer;
  NSMutableArray *_childSAs;
  NSObject<OS_dispatch_source> *_sendTimer;
  NSObject<OS_dispatch_source> *_receiveTimer;
  unsigned long long _uniqueIndex;
  NSMutableArray *_pendingRequestContexts;
  struct NEVirtualInterface_s * _ipsecInterface;
  NEIKEv2IKESA *_ikeSA;
  NSObject<NEIKEv2ConfigurationDelegate> *_configurationDelegate;
  NSObject<NEIKEv2PacketDelegate> *_packetDelegate;
  NEIKEv2RTT *_rttState;
  NSObject<OS_dispatch_queue> *_queue;
  NEIKEv2Packet *_previousMOBIKERequest;
  NEIKEv2IKESAConfiguration *_ikeConfig;
}

@property (retain) NSObject<OS_dispatch_queue> *clientQueue;
@property (readonly) unsigned long long state;
@property (readonly) NEIKEv2ConfigurationMessage *assignedConfiguration;
@property (readonly) NWEndpoint *localEndpoint;
@property (readonly) NWEndpoint *remoteEndpoint;
@property (readonly) NSString *ikeInterfaceName;
@property undefined * clientCallback;
@property void * clientCallbackInfo;
@property (copy) id /* block */ stateUpdateBlock;
@property (copy) id /* block */ childStateUpdateBlock;
@property (copy) id /* block */ configurationUpdateBlock;
@property (copy) id /* block */ trafficSelectorUpdateBlock;
@property (copy) id /* block */ additionalAddressesUpdateBlock;
@property (copy) id /* block */ shortDPDEventBlock;
@property (copy) id /* block */ redirectEventBlock;
@property (copy) id /* block */ privateNotifyStatusEvent;
@property (readonly) BOOL peerAuthenticated;
@property (readonly) unsigned long long hash;
@property (readonly) Class superclass;
@property (readonly, copy) NSString *description;
@property (readonly, copy) NSString *debugDescription;

/* instance methods */
- (void)dealloc;
- (void)expireSA:(id)sa;
- (void)deleteSA:(id)sa;
- (void)idleTimeoutSA:(id)sa;
- (void)blackholeDetectedSA:(id)sa;
- (void)reportError:(int)error;
- (id)initWithIKEConfig:(id)ikeconfig firstChildConfig:(id)config sessionConfig:(id)config queue:(id)queue ipsecInterface:(struct NEVirtualInterface_s *)interface ikeSocketHandler:(id /* block */)handler saSession:(id)session packetDelegate:(id)delegate;
- (id)initWithIKEConfig:(id)ikeconfig firstChildConfig:(id)config sessionConfig:(id)config queue:(id)queue ipsecInterface:(struct NEVirtualInterface_s *)interface ikeSocketHandler:(id /* block */)handler kernelSASessionName:(id)name packetDelegate:(id)delegate;
- (void)connect;
- (void)disconnect;
- (void)forceRekeyIKE;
- (void)forceRekeyChild:(unsigned int)child;
- (void)removeChild:(unsigned int)child;
- (BOOL)updateConfiguration:(id)configuration;
- (void)sendKeepaliveWithRetries:(unsigned int)retries retryIntervalInMilliseconds:(unsigned long long)milliseconds callbackQueue:(id)queue callback:(id /* block */)callback;
- (void)sendPrivateNotifies:(id)notifies maxRetries:(unsigned int)retries retryIntervalInMilliseconds:(unsigned long long)milliseconds callbackQueue:(id)queue callback:(id /* block */)callback;
- (void)sendMOBIKEWithRetries:(unsigned int)retries retryInterval:(unsigned long long)interval interfaceName:(id)name invalidateTransport:(BOOL)transport resetEndpoint:(id)endpoint callbackQueue:(id)queue callback:(id /* block */)callback;
- (unsigned int)addChild:(id)child;
- (void)receivePacket:(id)packet;
- (void)invalidateWithCompletionHandler:(BOOL)handler completionHandler:(id /* block */)handler;
- (void)invalidate;
- (BOOL)checkSelectedIKEProposal:(id)ikeproposal;
- (BOOL)checkSelectedChildSAProposal:(id)saproposal;
@end

#endif /* NEIKEv2Session_h */
